<!-- Backdrop -->
<div *ngIf="isOpen" class="cart-backdrop" (click)="closeCart()"></div>

<!-- Cart Sidebar -->
<div [class]="'cart-sidebar ' + (isOpen ? 'open' : '')">
  <div class="cart-content">
    <!-- Header -->
    <div class="cart-header">
      <h2 class="cart-title">Cart</h2>
      <button
        (click)="closeCart()"
        class="cart-close-btn"
        aria-label="Close cart"
      >
        <svg
          class="close-icon"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M15.7128 16.7729C16.0057 17.0658 16.4805 17.0658 16.7734 16.7729C17.0663 16.48 17.0663 16.0052 16.7734 15.7123L13.0611 12L16.7734 8.2877C17.0663 7.99481 17.0663 7.51993 16.7734 7.22704C16.4805 6.93415 16.0057 6.93415 15.7128 7.22704L12.0005 10.9393L8.28815 7.22699C7.99526 6.9341 7.52038 6.9341 7.22749 7.22699C6.9346 7.51989 6.9346 7.99476 7.22749 8.28765L10.9398 12L7.22748 15.7123C6.93459 16.0052 6.93459 16.4801 7.22748 16.773C7.52038 17.0659 7.99525 17.0659 8.28814 16.773L12.0005 13.0606L15.7128 16.7729Z"
            fill="#C4C4C4"
          />
        </svg>
      </button>
    </div>

    <!-- Cart Items -->
    <div class="cart-items">
      @if (items.length === 0) {
        <div class="cart-empty">
          <p class="empty-text">Your cart is empty</p>
        </div>
      } @else {
        @for (item of items; track item.id) {
          <div class="cart-item">
            <!-- Product Image -->
            <div class="cart-item-image">
              <div class="product-image-box">
                <img
                  [src]="item.image"
                  [alt]="item.name"
                  class="product-image"
                />
              </div>
              <!-- Veg/Non-Veg Indicator -->
              <div
                [class]="'veg-indicator ' + (item.isVeg ? 'veg' : 'non-veg')"
              >
                <div class="veg-dot"></div>
              </div>
            </div>

            <!-- Product Details -->
            <div class="cart-item-details">
              <h3 class="item-name">{{ item.name }}</h3>
              <p class="item-weight">{{ item.weight }}</p>
              <p class="item-price">${{ item.price.toFixed(2) }}</p>
            </div>

            <!-- Quantity Controls -->
            <div class="quantity-controls">
              <!-- Decrease Button -->
              <button
                (click)="decreaseQuantity(item.id, item.quantity)"
                class="qty-btn qty-decrease"
                aria-label="Decrease quantity"
              >
                <svg
                  class="qty-icon"
                  viewBox="0 0 16 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M4 8H12"
                    stroke="#AF0A09"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>

              <!-- Quantity Display -->
              <div class="qty-display">
                <span class="qty-value">
                  {{ item.quantity.toString().padStart(2, "0") }}
                </span>
              </div>

              <!-- Increase Button -->
              <button
                (click)="increaseQuantity(item.id, item.quantity)"
                class="qty-btn qty-increase"
                aria-label="Increase quantity"
              >
                <svg
                  class="qty-icon"
                  viewBox="0 0 16 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M12 8.5H4C3.72667 8.5 3.5 8.27333 3.5 8C3.5 7.72667 3.72667 7.5 4 7.5H12C12.2733 7.5 12.5 7.72667 12.5 8C12.5 8.27333 12.2733 8.5 12 8.5Z"
                    fill="white"
                  />
                  <path
                    d="M8 12.5C7.72667 12.5 7.5 12.2733 7.5 12V4C7.5 3.72667 7.72667 3.5 8 3.5C8.27333 3.5 8.5 3.72667 8.5 4V12C8.5 12.2733 8.27333 12.5 8 12.5Z"
                    fill="white"
                  />
                </svg>
              </button>
            </div>
          </div>
        }
      }
    </div>

    <!-- Footer -->
    @if (items.length > 0) {
      <div class="cart-footer">
        <!-- Total -->
        <div class="cart-total">
          <span class="total-label">Total</span>
          <span class="total-amount">${{ total.toFixed(2) }}</span>
        </div>

        <!-- Shipping Notice -->
        <p class="shipping-notice">
          Taxes, discounts and shipping calculated at checkout
        </p>

        <!-- Checkout Button -->
        <a routerLink="/checkout" class="checkout-btn"> Check Out </a>
      </div>
    }
  </div>
</div>
